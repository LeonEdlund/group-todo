CREATE TABLE users (
  user_id VARCHAR(50) NOT NULL PRIMARY KEY,
  username VARCHAR(255) NOT NULL,
  first_name VARCHAR(255) NOT NULL,
  last_name VARCHAR(255) NOT NULL
);

CREATE TABLE projects (
  project_id INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  owner_id VARCHAR(50) NOT NULL,
  title VARCHAR(255) NOT NULL,
  cover_svg LONGTEXT, 
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (owner_id) REFERENCES users(user_id) 
);

CREATE TABLE tasks (
  task_id INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  project_id INT(11) NOT NULL,
  assigned_to VARCHAR(50),
  completed_by VARCHAR(50),
  title VARCHAR(255) NOT NULL,
  description_text TEXT NOT NULL,
  difficulty_level TINYINT UNSIGNED NOT NULL CHECK(difficulty_level BETWEEN 1 AND 5),
  completion_status ENUM("not completed", "completed") NOT NULL DEFAULT "not completed",  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES projects(project_id) ON DELETE CASCADE,
  FOREIGN KEY (assigned_to) REFERENCES users(user_id) ON DELETE SET null,  
  FOREIGN KEY (completed_by) REFERENCES users(user_id) ON DELETE SET null  
);

CREATE TABLE project_members (
  id INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  user_id VARCHAR(50) NOT NULL,
  project_id int(11) NOT NULL,
  role ENUM("owner", "member") NOT NULL DEFAULT "member",
  FOREIGN KEY (user_id) REFERENCES users(user_id),  
  FOREIGN KEY (project_id) REFERENCES projects(project_id) ON DELETE CASCADE 
);

